<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sakura Tuition - Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Zen+Antique+Soft&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; overflow-x: hidden; }
        .zen-font { font-family: 'Zen Antique Soft', serif; }

        /* Sakura Animation */
        .sakura-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; overflow: hidden; }
        .petal { position: absolute; background-color: #ffd7e6; border-radius: 150% 0 150% 0; animation: animate-petal 10s linear infinite; }
        .petal::after { content: ""; position: absolute; top: -14%; left: -10%; width: 100%; height: 100%; border-radius: 150% 0 150% 0; background-color: #ffd7e6; transform: rotate(15deg); }
        @keyframes animate-petal {
            0% { opacity: 0; top: -10%; transform: translateX(0) rotate(0deg); }
            10% { opacity: 1; }
            100% { top: 110%; transform: translateX(-20px) rotate(225deg); }
        }

        /* Glassmorphism */
        .glass-nav { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.3); }
        .glass-card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(8px); border: 1px solid rgba(255, 255, 255, 0.6); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); transition: transform 0.3s ease; }
        .glass-card:hover { transform: translateY(-3px); }

        /* Nav & Filter Styles */
        .nav-link { position: relative; color: #4b5563; transition: color 0.3s; }
        .nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -4px; left: 0; background-color: #db2777; transition: width 0.3s; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        .nav-link.active { color: #db2777; font-weight: 600; }

        /* Circular Progress */
        .progress-ring { position: relative; width: 100px; height: 100px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: conic-gradient(#db2777 var(--progress), #f3f4f6 0deg); }
        .progress-ring::before { content: ""; position: absolute; width: 80px; height: 80px; border-radius: 50%; background-color: white; }
        .progress-ring-lg { width: 160px; height: 160px; background: conic-gradient(#db2777 var(--progress), #f3f4f6 0deg); }
        .progress-ring-lg::before { width: 130px; height: 130px; }
        .progress-value { position: relative; font-weight: bold; color: #374151; }

        /* Metric Colors */
        .ring-blue { background: conic-gradient(#3b82f6 var(--progress), #f3f4f6 0deg); }
        .ring-green { background: conic-gradient(#10b981 var(--progress), #f3f4f6 0deg); }
        .ring-purple { background: conic-gradient(#8b5cf6 var(--progress), #f3f4f6 0deg); }
        .ring-orange { background: conic-gradient(#f97316 var(--progress), #f3f4f6 0deg); }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-50 via-white to-pink-100 min-h-screen text-gray-700">

    <div id="sakura-container" class="sakura-container"></div>

    <!-- Navigation Bar -->
    <nav class="fixed top-0 w-full z-50 glass-nav px-6 py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center relative">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-500 border border-pink-200"><i class="fas fa-torii-gate"></i></div>
                <div><h1 class="text-xl font-bold text-gray-800 zen-font leading-none">Sakura</h1><span class="text-xs text-pink-500 font-medium tracking-widest">TUITION</span></div>
            </div>
            <div class="hidden md:flex items-center gap-8">
                <a href="studentdash.html" class="nav-link">Home</a>
                <a href="stdash.html" class="nav-link">Dashboard</a>
                <a href="stcourse.html" class="nav-link">Courses</a>
                <a href="stanalysiz.html" class="nav-link active">Analytics</a>
                <a href="stprofile.html" class="nav-link">Profile</a>
            </div>
            <div class="flex items-center gap-4">
                <div class="hidden sm:block text-right"><p id="userNameDisplay" class="text-sm font-bold text-gray-800">Student</p><p class="text-xs text-gray-500">N5 Level</p></div>
                <div class="relative hidden sm:block" id="profile-container">
                    <button onclick="toggleProfileMenu()" class="w-10 h-10 rounded-full bg-gradient-to-r from-pink-400 to-rose-400 p-0.5 shadow-md focus:outline-none transform active:scale-95 transition-transform">
                        <img src="https://api.dicebear.com/7.x/notionists/svg?seed=Felix" alt="User" class="w-full h-full rounded-full bg-white object-cover">
                    </button>
                    <div id="profile-dropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl py-2 hidden border border-gray-100 z-50 origin-top-right transition-all duration-200">
                        <a href="stprofile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-pink-50 hover:text-pink-600"><i class="fas fa-cog mr-2 text-gray-400"></i>Settings</a>
                        <button onclick="logout()" class="block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50"><i class="fas fa-sign-out-alt mr-2 text-red-400"></i>Sign Out</button>
                    </div>
                </div>
                <button id="mobile-menu-btn" class="md:hidden text-gray-600 text-2xl focus:outline-none p-2"><i class="fas fa-bars"></i></button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 w-full bg-white/95 backdrop-blur-md border-b border-gray-200 shadow-lg flex flex-col transition-all duration-300 transform origin-top">
            <a href="studentdash.html" class="px-6 py-4 border-b border-gray-100">Home</a>
            <a href="stdash.html" class="px-6 py-4 border-b border-gray-100">Dashboard</a>
            <a href="stcourse.html" class="px-6 py-4 border-b border-gray-100">Courses</a>
            <a href="stanalysiz.html" class="px-6 py-4 border-b border-gray-100">Analytics</a>
            <a href="stprofile.html" class="px-6 py-4 border-b border-gray-100">Profile</a>
            <button onclick="logout()" class="w-full text-left px-6 py-4 text-red-600">Sign Out</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="relative z-10 pt-24 pb-12 px-6 max-w-7xl mx-auto space-y-10">

        <!-- Header -->
        <div>
            <span class="text-pink-500 font-bold tracking-wider text-xs uppercase bg-pink-100 px-3 py-1 rounded-full border border-pink-200">Active Course</span>
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 zen-font mt-2">N5 Absolute Beginner</h2>
            <p class="text-gray-500 mt-1">Track your academic performance and attendance.</p>
        </div>

        <!-- 1. Performance Overview Section -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <!-- Overall Progress Card -->
            <div class="glass-card rounded-2xl p-8 flex flex-col items-center justify-center text-center border-t-4 border-pink-400 lg:col-span-1">
                <h3 class="text-lg font-bold text-gray-700 mb-6">Overall Course Completion</h3>
                <div class="progress-ring progress-ring-lg mb-4 shadow-inner" style="--progress: 68%;">
                    <div class="progress-value text-3xl font-bold text-gray-800">68%</div>
                </div>
                <p class="text-sm text-gray-500">You are ahead of schedule!</p>
                <div class="mt-4 flex gap-2 text-xs">
                    <span class="px-2 py-1 bg-green-100 text-green-700 rounded">Grade: A-</span>
                    <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded">Rank: 12/50</span>
                </div>
            </div>

            <!-- Detailed Metrics Grid -->
            <div class="lg:col-span-2 grid grid-cols-2 md:grid-cols-3 gap-4">
                
                <!-- Metric 1: Attendance -->
                <div class="glass-card rounded-2xl p-4 flex flex-col items-center justify-center text-center">
                    <div class="progress-ring ring-green mb-3" style="--progress: 85%;">
                        <div class="progress-value text-xl">85%</div>
                    </div>
                    <p class="text-sm font-bold text-gray-700">Live Attendance</p>
                    <p class="text-xs text-gray-500">17/20 Classes</p>
                </div>

                <!-- Metric 2: Recordings -->
                <div class="glass-card rounded-2xl p-4 flex flex-col items-center justify-center text-center">
                    <div class="progress-ring ring-blue mb-3" style="--progress: 40%;">
                        <div class="progress-value text-xl">40%</div>
                    </div>
                    <p class="text-sm font-bold text-gray-700">Recordings Watched</p>
                    <p class="text-xs text-gray-500">For missed classes</p>
                </div>

                <!-- Metric 3: Assignments -->
                <div class="glass-card rounded-2xl p-4 flex flex-col items-center justify-center text-center">
                    <div class="progress-ring ring-purple mb-3" style="--progress: 92%;">
                        <div class="progress-value text-xl">92%</div>
                    </div>
                    <p class="text-sm font-bold text-gray-700">Assignments</p>
                    <p class="text-xs text-gray-500">11/12 Submitted</p>
                </div>

                <!-- Metric 4: Quizzes -->
                <div class="glass-card rounded-2xl p-4 flex flex-col items-center justify-center text-center">
                    <div class="progress-ring ring-orange mb-3" style="--progress: 78%;">
                        <div class="progress-value text-xl">78%</div>
                    </div>
                    <p class="text-sm font-bold text-gray-700">Quizzes Done</p>
                    <p class="text-xs text-gray-500">Avg Score: 7.8/10</p>
                </div>

                <!-- Metric 5: Exams -->
                <div class="glass-card rounded-2xl p-4 flex flex-col items-center justify-center text-center md:col-span-2 lg:col-span-1">
                    <div class="progress-ring mb-3" style="--progress: 100%;">
                        <div class="progress-value text-xl">100%</div>
                    </div>
                    <p class="text-sm font-bold text-gray-700">Exams Attended</p>
                    <p class="text-xs text-gray-500">All terms completed</p>
                </div>
            </div>
        </section>

        <!-- 2. Exam Results Portal -->
        <section class="glass-card rounded-2xl p-6 md:p-8">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                <h3 class="text-2xl font-bold text-gray-800 zen-font flex items-center">
                    <i class="fas fa-graduation-cap mr-3 text-pink-500"></i> Exam Results
                </h3>
                
                <!-- Controls -->
                <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
                    <!-- Search -->
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search exam name..." class="pl-9 pr-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-pink-400 bg-white/50 w-full">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                    <!-- Filter -->
                    <div class="relative">
                        <select id="filterSelect" class="pl-9 pr-8 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-pink-400 bg-white/50 w-full appearance-none cursor-pointer">
                            <option value="recent">Recent First</option>
                            <option value="old">Oldest First</option>
                            <option value="high">High Grade</option>
                            <option value="low">Low Grade</option>
                        </select>
                        <i class="fas fa-filter absolute left-3 top-3 text-gray-400"></i>
                        <i class="fas fa-chevron-down absolute right-3 top-3 text-gray-400 text-xs pointer-events-none"></i>
                    </div>
                </div>
            </div>

            <!-- Results List -->
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="text-gray-500 text-xs uppercase border-b border-gray-200">
                            <th class="py-3 px-4 font-semibold">Exam Name</th>
                            <th class="py-3 px-4 font-semibold">Date</th>
                            <th class="py-3 px-4 font-semibold text-center">Score</th>
                            <th class="py-3 px-4 font-semibold text-center">Grade</th>
                            <th class="py-3 px-4 font-semibold text-right">Result Sheet</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody" class="text-sm">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
                <p id="noResultsMsg" class="hidden text-center text-gray-500 py-8">No exams found matching your search.</p>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white/60 border-t border-gray-200 mt-12 py-8 text-center backdrop-blur-sm">
        <p class="text-gray-500 text-sm">Â© 2026 Sakura Tuition. Designed with <i class="fas fa-heart text-pink-400"></i></p>
    </footer>

    <script>
        // --- 1. Mock Data ---
        const examResults = [
            { id: 1, name: 'Kanji Module 1 Final', date: '2026-03-15', score: 92, grade: 'A' },
            { id: 2, name: 'Grammar Particles Quiz', date: '2026-02-28', score: 78, grade: 'B' },
            { id: 3, name: 'Listening Comprehension', date: '2026-02-10', score: 85, grade: 'A-' },
            { id: 4, name: 'Vocabulary Sprint', date: '2026-01-20', score: 65, grade: 'C' },
            { id: 5, name: 'Hiragana & Katakana Basics', date: '2026-01-05', score: 98, grade: 'A+' },
            { id: 6, name: 'Verb Conjugation Test', date: '2026-04-02', score: 88, grade: 'A' }
        ];

        // --- 2. Render Logic ---
        function renderResults() {
            const tableBody = document.getElementById('resultsTableBody');
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            const filterVal = document.getElementById('filterSelect').value;
            const noResults = document.getElementById('noResultsMsg');

            // Filter
            let filtered = examResults.filter(exam => 
                exam.name.toLowerCase().includes(searchVal)
            );

            // Sort
            filtered.sort((a, b) => {
                if (filterVal === 'recent') return new Date(b.date) - new Date(a.date);
                if (filterVal === 'old') return new Date(a.date) - new Date(b.date);
                if (filterVal === 'high') return b.score - a.score;
                if (filterVal === 'low') return a.score - b.score;
                return 0;
            });

            // Clear
            tableBody.innerHTML = '';

            if (filtered.length === 0) {
                noResults.classList.remove('hidden');
                return;
            } else {
                noResults.classList.add('hidden');
            }

            // Populate
            filtered.forEach(exam => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100 hover:bg-white/60 transition-colors group';
                
                // Color code grade
                let gradeColor = 'bg-gray-100 text-gray-600';
                if(exam.grade.startsWith('A')) gradeColor = 'bg-green-100 text-green-700 border border-green-200';
                else if(exam.grade.startsWith('B')) gradeColor = 'bg-blue-100 text-blue-700 border border-blue-200';
                else if(exam.grade.startsWith('C')) gradeColor = 'bg-yellow-100 text-yellow-700 border border-yellow-200';
                else gradeColor = 'bg-red-100 text-red-700 border border-red-200';

                row.innerHTML = `
                    <td class="py-4 px-4 font-medium text-gray-800">${exam.name}</td>
                    <td class="py-4 px-4 text-gray-500">${exam.date}</td>
                    <td class="py-4 px-4 text-center font-bold text-gray-700">${exam.score}%</td>
                    <td class="py-4 px-4 text-center"><span class="${gradeColor} text-xs font-bold px-2 py-1 rounded">${exam.grade}</span></td>
                    <td class="py-4 px-4 text-right">
                        <button onclick="downloadResult('${exam.name}')" class="text-pink-500 hover:text-pink-700 hover:bg-pink-50 p-2 rounded transition" title="Download PDF">
                            <i class="fas fa-download"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // --- 3. Interaction Logic ---
        
        // Search & Filter Listeners
        document.getElementById('searchInput').addEventListener('input', renderResults);
        document.getElementById('filterSelect').addEventListener('change', renderResults);

        // Download Simulation
        function downloadResult(examName) {
            const btn = event.currentTarget;
            const icon = btn.querySelector('i');
            
            // Animation
            icon.className = "fas fa-spinner fa-spin";
            
            setTimeout(() => {
                alert(`Downloading Result Sheet:\n\nðŸ“„ ${examName}_Result.pdf\n\nDownload Complete!`);
                icon.className = "fas fa-check text-green-500";
                setTimeout(() => icon.className = "fas fa-download", 2000);
            }, 1000);
        }

        // --- 4. Shared Logic (Nav, Petals, Auth) ---
        
        // Init
        window.onload = function() {
            renderResults();
            
            // Auth Display
            const db = JSON.parse(localStorage.getItem('sakura_users') || '{}');
            const currentUser = localStorage.getItem('sakura_current_user');
            if (currentUser && db[currentUser]) {
                 document.getElementById('userNameDisplay').textContent = db[currentUser].name;
            } else {
                 document.getElementById('userNameDisplay').textContent = "Vismal Kethmika";
            }
        };

        // Sakura Animation
        function createPetal() {
            const container = document.getElementById('sakura-container');
            const petal = document.createElement('div'); petal.classList.add('petal');
            petal.style.left = Math.random() * 100 + '%'; petal.style.width = (Math.random() * 10 + 10) + 'px'; petal.style.height = petal.style.width;
            petal.style.animationDuration = (Math.random() * 5 + 8) + 's'; petal.style.opacity = Math.random() * 0.5 + 0.3;
            container.appendChild(petal); setTimeout(() => petal.remove(), 13000);
        }
        setInterval(createPetal, 1000);

        // Nav
        const mobileBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        if(mobileBtn) mobileBtn.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
        function toggleProfileMenu() { document.getElementById('profile-dropdown').classList.toggle('hidden'); }
        document.addEventListener('click', e => {
            if(!document.getElementById('profile-container').contains(e.target)) 
                document.getElementById('profile-dropdown').classList.add('hidden');
        });
        function logout() { if(confirm("Log out?")) window.location.href = 'index.html'; }

    </script>
</body>
</html>